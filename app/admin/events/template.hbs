{{title 'Events'}}
{{remember-document-scroll key='events'}}

<div id="events">
  <div class="frame">
    <header>
      <h2>
        {{search-field query=q onquery=(action (mut q)) placeholder="Events"}}
      </h2>
      {{#link-to (query-params as='list')}}
        {{icon 'list'}} List
      {{/link-to}}
      {{#link-to (query-params as='calendar')}}
        {{icon 'calendar'}} Calendar
      {{/link-to}}
    </header>
    {{#if (equals as 'list')}}
      <nav>
        {{#action-link action=(action (mut isAdding) true)}}
          {{icon "calendar"}} Add Event
        {{/action-link}}
      </nav>
    {{/if}}
  </div>
  {{#if (equals as 'list')}}
    {{#sortable-list load=(route-action 'load') rows=model.model total=model.meta.page.total sort=sort icon='calendar' as |l|}}
      {{#l.item 'title' as |item|}}
        {{item.title}}
      {{else}}
        Title
      {{/l.item}}
      {{#l.item 'startsAt' '-endsAt' as |item|}}
        {{l 'date' item.startsAt}} - {{l 'date' item.endsAt}}
      {{else}}
        Date
      {{/l.item}}
    {{/sortable-list}}
  {{else}}
    {{#event-planner events=model.model oncreate=(route-action 'createEvent') onquery=(route-action 'query') as |event|}}
      {{#link-to 'admin.event' event}}{{event.title}}{{/link-to}}
    {{/event-planner}}
  {{/if}}

  {{#if isAdding}}
    {{dialog-box (component 'new-event-dialog'
        onsubmit=(route-action 'createEvent'))
      ondismiss=(action (mut isAdding) false)}}
  {{/if}}
</div>