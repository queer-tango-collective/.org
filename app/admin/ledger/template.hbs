{{title "Ledger"}}

<div id="ledger">
  <header>
    {{search-field query=q onquery=(action (mut q)) placeholder="Ledger"}}
  </header>
  <nav>
    <button type='submit' onclick={{action (mut isDonating) true}}>
      {{icon "piggy-bank"}} Add Donation
    </button>
    <button type='submit' onclick={{action (mut isExpensing) true}}>
      {{icon "currency-solid"}} Add Expense
    </button>
    {{#if isExpensing}}
      {{dialog-box (component 'new-expense-dialog'
          onsubmit=(route-action 'createTransaction'))
        ondismiss=(action (mut isExpensing) false)}}
    {{/if}}
    {{#if isDonating}}
      {{dialog-box (component 'new-donation-dialog'
          onsubmit=(route-action 'createTransaction'))
        ondismiss=(action (mut isDonating) false)}}
    {{/if}}
  </nav>
  {{!balance-bar balance=model.meta.balance credit=model.meta.credit debit=model.meta.debit}}
  {{#sortable-list rows=model.model total=model.meta.page.total load=(route-action 'load') sort=sort icon='piggy-bank' as |list|}}
    {{#list.item 'description' as |item|}}
      {{item.description}}
    {{else}}
      Description
    {{/list.item}}
    {{#list.item 'paidBy' as |item|}}
      {{item.paidBy}}
    {{else}}
      Paid By
    {{/list.item}}
    {{#list.item 'paidAt' as |item|}}
      {{item.paidAt}}
    {{else}}
      Paid At
    {{/list.item}}
    {{#list.item 'amountPaid' as |item|}}
      {{l 'currency' item.amountPaid}}
    {{else}}
      Amount
    {{/list.item}}
    {{#list.item 'amountOwed' as |item|}}
      {{#if item.amountOwed}}
        {{l 'currency' item.amountOwed}}
      {{/if}}
    {{else}}
      Owed
    {{/list.item}}
  {{/sortable-list}}
</div>
