{{title 'Tickets'}}
{{remember-document-scroll key='tickets'}}

<section id="tickets">
  <header>
    <h2>
      {{search-field query=q onquery=(action (mut q)) placeholder="Search tickets by description"}}
    </h2>
  </header>
  <nav>
    <button type='submit' onclick={{action (mut isAdding) true}}>
      {{icon "ticket"}} Add Ticket
    </button>
    {{#if isAdding}}
      {{dialog-box (component 'new-ticket-dialog'
          onsubmit=(route-action 'createTicket'))
        ondismiss=(action (mut isAdding) false)}}
    {{/if}}
  </nav>
  {{#sortable-list load=(route-action 'load') rows=model.model total=model.meta.page.total sort=sort icon='ticket' as |l|}}
    {{#l.item 'is-active' sortable=false as |item|}}
      <span class="status {{if item.isActive 'active'}}"></span>
    {{else}}
      <span class='is-active'>&nbsp;</span>
    {{~/l.item}}
    {{#l.item 'description' as |item|}}
      {{#link-to 'ticket' item}}{{item.description}}{{/link-to}}
    {{else}}
      Description
    {{/l.item}}
    {{#l.item 'cost' as |item|}}
      {{l 'currency' item.cost currency=item.currency}}
    {{else}}
      Cost
    {{/l.item}}
    {{#l.item 'numberSold' as |item|}}
      {{item.numberSold}}
    {{else}}
      # Sold
    {{/l.item}}
  {{/sortable-list}}
</section>
