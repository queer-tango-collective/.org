{{title model.description}}
{{remember-document-scroll key=(concat 'ticket/' model.id)}}

<section id="ticket">
  {{#form-for model autosave=true onsubmit=(route-action 'save') onsaved=(route-action 'flash' (concat 'Saved ' model.description)) as |f|}}
    {{#f.nav ondelete=(route-action 'deleteRecord')}}
      <button type='submit' onclick={{action (mut isAddingEvents) true}}>
        {{icon 'add'}} Add Events
      </button>
      {{#if isAddingEvents}}
        {{dialog-box (component 'find-event-dialog'
            disabled=model.events
            onsubmit=(route-action 'createTicketedEvents' model))
          ondismiss=(action (mut isAddingEvents) false)}}
      {{/if}}
      <button type='submit' onclick={{action (mut isAddingStub) true}}>
        {{icon 'person'}} Add Attendee
      </button>
    {{/f.nav}}
    <div class='grid-column'>
      {{f.text 'description'}}
      <div class='grid-row'>
        {{f.currency 'cost'}}
        {{f.number 'quantity'}}
      </div>
      <div class='grid-row'>
        {{f.datetime 'validFrom'}}
        {{f.datetime 'validTo'}}
      </div>
    </div>
    {{#tabular-list rows=model.events as |l|}}
      {{#l.item 'title' as |item|}}
        {{item.title}}
      {{else}}
        Title
      {{/l.item}}
      {{#l.item 'date' as |item|}}
        {{l 'date' item.startsAt}}
      {{else}}
        Date
      {{/l.item}}
    {{/tabular-list}}
  {{/form-for}}
</section>
