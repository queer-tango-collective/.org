{{remember-document-scroll key=(concat 'post/' model.id '/edit')}}
{{title model.title}}

{{#file-dropzone name=(concat 'post/' model.id '/photo/new')}}
<section id="post-edit">
  {{#form-for model autosave=true onsubmit=(route-action 'save') onsaved=(route-action 'flash' (concat 'Saved ' model.title)) as |f|}}
    <nav class='row'>
      {{#confirm-button onsubmit=(route-action 'deleteRecord' model)}}
        {{icon "trash"}} Delete Post
      {{/confirm-button}}
      {{#if model.published}}
        {{#submit-button onsubmit=(route-action 'unpublish' model)}}
          {{icon "eye-closed"}} Unpublish
        {{/submit-button}}
      {{else}}
        {{#submit-button onsubmit=(route-action 'publish' model)}}
          {{icon "eye"}} Publish
        {{/submit-button}}
      {{/if}}
    </nav>
    <div class="grid-column">
      {{f.text 'title'}}
      {{f.text 'slug'}}
      {{f.editor 'body' rows=6
        onupload=(route-action 'addPhoto' model) embeds=(list
          (hash type='ticket'
                label='Add Ticket'
                icon='ticket'
                onembed=(route-action 'findOrCreateTicket'
                  (component 'find-ticket-dialog')
                )
          )
          (hash type='calendar'
                label='Add Calendar'
                icon='calendar'
                onembed=(route-action 'findOrCreateEvent'
                  (component 'find-event-dialog')
                )
          )
        )}}
    </div>
  {{/form-for}}
</section>
{{/file-dropzone}}